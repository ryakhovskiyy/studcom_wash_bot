# üß∫ StudCom Wash Bot

**StudCom Wash Bot** ‚Äî —ç—Ç–æ Telegram-–±–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ –≤ –ø—Ä–∞—á–µ—á–Ω—É—é –æ–±—â–µ–∂–∏—Ç–∏—è (—Å–æ–∑–¥–∞–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ú–µ—Ö–º–∞—Ç–∞ –ú–ì–£).

–ë–æ–ª—å—à–µ –Ω–∏–∫–∞–∫–∏—Ö "–∂–∏–≤—ã—Ö –æ—á–µ—Ä–µ–¥–µ–π" –∏ –±—É–º–∞–∂–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤! –ë–æ—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∏–¥–µ—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è —Å—Ç–∏—Ä–∫–∏ –æ–Ω–ª–∞–π–Ω –∏ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

---

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–æ—á—Ç—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `@math.msu.ru`).
* **–û–Ω–ª–∞–π–Ω-–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å.
* **–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç:** –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω—ã.
* **–£–º–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ:**
    * –ü—Ä–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–ª–æ—Ç –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –∏–∑ *–†–∞—Å–ø–∏—Å–∞–Ω–∏—è* –≤ *–ê—Ä—Ö–∏–≤*.
    * –ü—Ä–∏ –æ—Ç–º–µ–Ω–µ –∑–∞–ø–∏—Å–∏ —Å–ª–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ *–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ*, —á—Ç–æ–±—ã –µ–≥–æ –º–æ–≥–ª–∏ –∑–∞–Ω—è—Ç—å –¥—Ä—É–≥–∏–µ.
* **–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:** –°–≤—è–∑—å —Å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∑–∞ —Å—Ç–∏—Ä–∫—É (—Å—Ç–∞—Ä–æ—Å—Ç–∞–º–∏) –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤.
* **Google Sheets –∫–∞–∫ –ë–î:** –ü—Ä–æ—Å—Ç–æ–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö.

---

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone [https://github.com/ryakhovskiyy/studcom_wash_bot.git](https://github.com/ryakhovskiyy/studcom_wash_bot.git)
cd studcom_wash_bot
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `venv` –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

**Linux/macOS:**
```bash
python3 -m venv venv
source venv/bin/activate
```

**Windows:**
```bash
python -m venv venv
venv\Scripts\activate
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞ `requirements.txt`:

```bash
pip install -r requirements.txt
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

–°–æ–∑–¥–∞–π—Ç–µ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Ñ–∞–π–ª `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏:

```ini
# –¢–æ–∫–µ–Ω –±–æ—Ç–∞, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —É @BotFather
TELEGRAM_TOKEN="–≤–∞—à_—Ç–æ–∫–µ–Ω_–∑–¥–µ—Å—å"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ SMTP –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–¥–æ–≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–ø—Ä–∏–º–µ—Ä –¥–ª—è Yandex)
SMTP_SERVER="smtp.yandex.ru"
SMTP_PORT=465
SMTP_USER="example@yandex.ru"
SMTP_PASSWORD="–ø–∞—Ä–æ–ª—å_–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è_–æ—Ç_–ø–æ—á—Ç—ã"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Google –¢–∞–±–ª–∏—Ü
SERVICE_ACCOUNT_FILE="credentials.json"
SHEET_NAME="WashBot_DB"
```

> **–í–∞–∂–Ω–æ:** –î–ª—è —Å–º–µ–Ω—ã —Ñ–æ—Ä–º–∞—Ç–∞ –ø–æ—á—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `@math.msu.ru`) –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `handlers/user/registration.py` (—Ñ—É–Ω–∫—Ü–∏—è `ask_email_and_send_code`).

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Cloud

1.  –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ [Google Cloud Console](https://console.cloud.google.com/).
2.  –í–∫–ª—é—á–∏—Ç–µ API: **Google Drive API** –∏ **Google Sheets API**.
3.  –°–æ–∑–¥–∞–π—Ç–µ **Service Account** (–°–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç).
4.  –°–æ–∑–¥–∞–π—Ç–µ –∏ —Å–∫–∞—á–∞–π—Ç–µ JSON-–∫–ª—é—á –¥–ª—è —ç—Ç–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.
5.  –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ `credentials.json` –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞.
6.  **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:** –û—Ç–∫—Ä–æ–π—Ç–µ JSON-—Ñ–∞–π–ª, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ `client_email` –∏ –¥–∞–π—Ç–µ —ç—Ç–æ–º—É email **–ø—Ä–∞–≤–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞** –≤ –≤–∞—à–µ–π Google –¢–∞–±–ª–∏—Ü–µ.

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Google –¢–∞–±–ª–∏—Ü—ã

–¢–∞–±–ª–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è —Ç–∞–∫ –∂–µ, –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `SHEET_NAME` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `WashBot_DB`) –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å 4 –ª–∏—Å—Ç–∞.

### 1. –õ–∏—Å—Ç `users` (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
–•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| `telegram_id` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Peer ID) |
| `username` | –Æ–∑–µ—Ä–Ω–µ–π–º Telegram |
| `surname` | –§–∞–º–∏–ª–∏—è |
| `first_name` | –ò–º—è |
| `patronymic` | –û—Ç—á–µ—Å—Ç–≤–æ |
| `date_of_birth` | –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è |
| `room_number` | –ù–æ–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã |
| `email` | –ü–æ—á—Ç–∞ |
| `email_status` | –°—Ç–∞—Ç—É—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ—á—Ç—ã |
| `rules_acknowledged` | –û–∑–Ω–∞–∫–æ–º–ª–µ–Ω —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ |
| `status` | –°—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–∞ (`ok` / `block`) |
| `paper_sign` | –†–æ—Å–ø–∏—Å—å –≤ –±—É–º–∞–∂–Ω–æ–º –∂—É—Ä–Ω–∞–ª–µ (`1` / `0`) |

### 2. –õ–∏—Å—Ç `schedule` (–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã)
–°—é–¥–∞ –≤–Ω–æ—Å—è—Ç—Å—è —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã.

| –ö–æ–ª–æ–Ω–∫–∞ | –ü—Ä–∏–º–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| `slot_date` | `25.11.2023` | –î–∞—Ç–∞ (DD.MM.YYYY) |
| `start_time` | `18:00` | –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ (HH:MM) |
| `end_time` | `20:00` | –í—Ä–µ–º—è –∫–æ–Ω—Ü–∞ (HH:MM) |
| `floor` | `9` | –ù–æ–º–µ—Ä —Å—Ç–∏—Ä–∞–ª–∫–∏/–≠—Ç–∞–∂ |
| `responsible` | `IVAN` | –ò–º—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ (–∫–ª—é—á –∏–∑ config) |

### 3. –õ–∏—Å—Ç `archive` (–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ/–ò—Å—Ç–æ—Ä–∏—è)
–°—é–¥–∞ –ø–æ–ø–∞–¥–∞—é—Ç –∑–∞–ø–∏—Å–∏ –ø–æ—Å–ª–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| `slot_date`, `start_time`, `end_time`, `floor`, `responsible` | –î–∞–Ω–Ω—ã–µ –æ —Å–ª–æ—Ç–µ (–∫–∞–∫ –≤ schedule) |
| `telegram_id`, `username`, `full_name` | –î–∞–Ω–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç–∞ |
| `booking_timestamp` | –í—Ä–µ–º—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è |
| `status` | –°—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏: `Booked` (–∞–∫—Ç–∏–≤–Ω–∞) –∏–ª–∏ `Canceled` (–æ—Ç–º–µ–Ω–µ–Ω–∞) |

### 4. –õ–∏—Å—Ç `config` (–ù–∞—Å—Ç—Ä–æ–π–∫–∏)
–°–ª–æ–≤–∞—Ä—å `key` -> `value`.

**–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
* `BOOKING_LIMIT`: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `2`).

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö (—Å—Ç–∞—Ä–æ—Å—Ç):**
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–º–µ–Ω–∏ (`NAME`), –∫–æ—Ç–æ—Ä–æ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏, –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å 3 –∫–ª—é—á–∞:

1.  `responsible_NAME_contact`: –ö–æ–Ω—Ç–∞–∫—Ç —Å—Ç–∞—Ä–æ—Å—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `@username`), –∫–æ—Ç–æ—Ä—ã–π –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.
2.  `responsible_NAME_key_room`: –ö–æ–º–Ω–∞—Ç–∞, –≥–¥–µ –∑–∞–±—Ä–∞—Ç—å –∫–ª—é—á (–Ω–∞–ø—Ä–∏–º–µ—Ä, `–ë915`).
3.  `responsible_NAME_peer_id`: Telegram ID —Å—Ç–∞—Ä–æ—Å—Ç—ã (—á—Ç–æ–±—ã –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–ª –µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —Å—Ç–∞—Ä–æ—Å—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –±–æ—Ç–∞).

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
python bot.py
```

---
**–ö–æ–Ω—Ç–∞–∫—Ç—ã:**
–ê–ª–µ–∫—Å–µ–π –†—è—Ö–æ–≤—Å–∫–∏–π | [Telegram](t.me/ryakhovskiyy)
